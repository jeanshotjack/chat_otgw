{"ast":null,"code":"import { put, takeLatest } from 'redux-saga/effects';\nimport { messagesLoaded } from '../actions';\nconst messageDetails = {\n  '2': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'The Beast?',\n    createdAt: 'Oct 20',\n    isMyMessage: true\n  }, {\n    id: '2',\n    imageUrl: require('../../images/profiles/greg.png'),\n    imageAlt: 'Greg',\n    messageText: `\n                I'm going to save my brother Wirt from the Beast! .\n            `,\n    createdAt: 'Oct 20',\n    isMyMessage: false\n  }, {\n    id: '3',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Why are you in the woods alone?',\n    createdAt: 'Oct 19',\n    isMyMessage: true\n  }, {\n    id: '4',\n    imageUrl: require('../../images/profiles/greg.png'),\n    imageAlt: 'Greg',\n    messageText: `\n                I'm an elephant! Look at my teapot hat! It's a trunk! \n            `,\n    createdAt: 'Oct 19',\n    isMyMessage: false\n  }, {\n    id: '5',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: `\n                What are you supposed to be? \n            `,\n    createdAt: 'Oct 19',\n    isMyMessage: true\n  }, {\n    id: '6',\n    imageUrl: require('../../images/profiles/greg.png'),\n    imageAlt: 'Greg',\n    messageText: `\n                Do you like my costume? \n            `,\n    createdAt: 'Oct 19',\n    isMyMessage: false\n  }, {\n    id: '7',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'No Greg, I do not.',\n    createdAt: 'Oct 19',\n    isMyMessage: true\n  }, {\n    id: '8',\n    imageUrl: require('../../images/profiles/greg.png'),\n    imageAlt: 'Greg',\n    messageText: 'Hey! Do you have candy? ',\n    createdAt: 'Oct 19',\n    isMyMessage: false\n  }, {\n    id: '9',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hey Greg?',\n    createdAt: 'Oct 19',\n    isMyMessage: true\n  }],\n  '3': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hey',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '4': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hey',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '5': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hey',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '6': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hey',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '7': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hey',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '8': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hey',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '9': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hey',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }]\n};\n\nconst delay = ms => new Promise(res => setTimeout(res, ms));\n\nconst messagesSaga = function* (action) {\n  const {\n    conversationId,\n    numberOfMessages,\n    lastMessageId\n  } = action.payload;\n  const messages = messageDetails[conversationId];\n  const startIndex = lastMessageId ? messages.findIndex(message => message.id === lastMessageId) + 1 : 0;\n  const endIndex = startIndex + numberOfMessages;\n  const pageGroup = messages.slice(startIndex, endIndex);\n  const newLastMessageId = pageGroup.length > 0 ? pageGroup[pageGroup.length - 1].id : null;\n  const hasMoreMessages = newLastMessageId && endIndex < messages.length - 1;\n  yield delay(1000);\n  yield put(messagesLoaded(conversationId, pageGroup, hasMoreMessages, newLastMessageId));\n\n  if (hasMoreMessages) {\n    yield delay(1000);\n    yield put({\n      type: 'MESSAGES_REQUESTED',\n      payload: {\n        conversationId,\n        numberOfMessages,\n        lastMessageId: newLastMessageId\n      }\n    });\n  }\n};\n\nexport const watchGetMessagesAsync = function* () {\n  yield takeLatest('MESSAGES_REQUESTED', messagesSaga);\n};","map":{"version":3,"sources":["/Users/Jack/Documents/otgw_chat/src/store/sagas/messages.js"],"names":["put","takeLatest","messagesLoaded","messageDetails","id","imageUrl","imageAlt","messageText","createdAt","isMyMessage","require","delay","ms","Promise","res","setTimeout","messagesSaga","action","conversationId","numberOfMessages","lastMessageId","payload","messages","startIndex","findIndex","message","endIndex","pageGroup","slice","newLastMessageId","length","hasMoreMessages","type","watchGetMessagesAsync"],"mappings":"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","sourcesContent":["import { put, takeLatest } from 'redux-saga/effects';\n\nimport { messagesLoaded } from '../actions';\n\nconst messageDetails = {\n    '2': [\n        {\n            id: '1',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'The Beast?',\n            createdAt: 'Oct 20',\n            isMyMessage: true\n        },\n        {\n            id: '2',\n            imageUrl: require('../../images/profiles/greg.png'),\n            imageAlt: 'Greg',\n            messageText: `\n                I'm going to save my brother Wirt from the Beast! .\n            `,\n            createdAt: 'Oct 20',\n            isMyMessage: false\n        },\n        {\n            id: '3',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'Why are you in the woods alone?',\n            createdAt: 'Oct 19',\n            isMyMessage: true\n        },\n        {\n            id: '4',\n            imageUrl: require('../../images/profiles/greg.png'),\n            imageAlt: 'Greg',\n            messageText: `\n                I'm an elephant! Look at my teapot hat! It's a trunk! \n            `,\n            createdAt: 'Oct 19',\n            isMyMessage: false\n        },\n        {\n            id: '5',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: `\n                What are you supposed to be? \n            `,\n            createdAt: 'Oct 19',\n            isMyMessage: true\n        },\n        {\n            id: '6',\n            imageUrl: require('../../images/profiles/greg.png'),\n            imageAlt: 'Greg',\n            messageText: `\n                Do you like my costume? \n            `,\n            createdAt: 'Oct 19',\n            isMyMessage: false\n        },\n        {\n            id: '7',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'No Greg, I do not.',\n            createdAt: 'Oct 19',\n            isMyMessage: true\n        },\n        {\n            id: '8',\n            imageUrl: require('../../images/profiles/greg.png'),\n            imageAlt: 'Greg',\n            messageText: 'Hey! Do you have candy? ',\n            createdAt: 'Oct 19',\n            isMyMessage: false\n        },\n        {\n            id: '9',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'Hey Greg?',\n            createdAt: 'Oct 19',\n            isMyMessage: true\n        }\n    ],\n    '3': [\n        {\n            id: '1',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'Hey',\n            createdAt: '1 week ago',\n            isMyMessage: true\n        }\n    ],\n    '4': [\n        {\n            id: '1',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'Hey',\n            createdAt: '1 week ago',\n            isMyMessage: true\n        }\n    ],\n    '5': [\n        {\n            id: '1',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'Hey',\n            createdAt: '1 week ago',\n            isMyMessage: true\n        }\n    ],\n    '6': [\n        {\n            id: '1',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'Hey',\n            createdAt: '1 week ago',\n            isMyMessage: true\n        }\n    ],\n    '7': [\n        {\n            id: '1',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'Hey',\n            createdAt: '1 week ago',\n            isMyMessage: true\n        }\n    ],\n    '8': [\n        {\n            id: '1',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'Hey',\n            createdAt: '1 week ago',\n            isMyMessage: true\n        }\n    ],\n    '9': [\n        {\n            id: '1',\n            imageUrl: null,\n            imageAlt: null,\n            messageText: 'Hey',\n            createdAt: '1 week ago',\n            isMyMessage: true\n        }\n    ]\n};\n\nconst delay = (ms) => new Promise(res => setTimeout(res, ms));\n\nconst messagesSaga = function*(action) {\n    const { conversationId, numberOfMessages, lastMessageId } = action.payload;\n    const messages = messageDetails[conversationId];\n    const startIndex = lastMessageId ? messages.findIndex(message => message.id === lastMessageId) + 1: 0;\n    const endIndex = startIndex + numberOfMessages;\n    const pageGroup = messages.slice(startIndex, endIndex);\n    const newLastMessageId = pageGroup.length > 0 ? pageGroup[pageGroup.length - 1].id: null;\n    const hasMoreMessages = newLastMessageId && endIndex < (messages.length - 1);\n\n    yield delay(1000);\n\n    yield put(messagesLoaded(\n        conversationId,\n        pageGroup,\n        hasMoreMessages,\n        newLastMessageId\n    ));\n\n    if (hasMoreMessages) {\n        yield delay(1000);\n        yield put({\n            type: 'MESSAGES_REQUESTED',\n            payload: {\n                conversationId,\n                numberOfMessages,\n                lastMessageId: newLastMessageId\n            }\n        })\n    }\n}\n\nexport const watchGetMessagesAsync = function*() {\n    yield takeLatest('MESSAGES_REQUESTED', messagesSaga);\n}"]},"metadata":{},"sourceType":"module"}